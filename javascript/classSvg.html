<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="stylesheets/guidostylesheet.css" type="text/css" charset="UTF-8" />
    <script src="libGUIDOEngine.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
    <style type="text/css">
      div.column {
        display: block;
        width: 50%;
      }
      #gmnSandbox {
        width: 95%;
      }
      #guidoResult {
        /*border: 0px;*/
      }
    </style>
    <script>
		
	function processGMN() {
		console.log("processGMN");
		var guidoEngine = new Module.GuidoEngineAdapter;
		guidoEngine.GuidoInit();
		var p = guidoEngine.GuidoOpenParser();
		var ar = guidoEngine.GuidoString2AR(p, $("#gmnSandbox").val());
		//alert (ar);
		var result = guidoEngine.getSvg(p, $("#gmnSandbox").val());
		guidoEngine.CloseParser(p);
		//var vector = guidoEngine.returnVector();
		//alert(vector);
		//alert(vector.get(0) + vector.get(1));
		
		var settings= {
			systemsDistance : 75,
			systemsDistribution : 1,
			systemsDistribLimit : 0.25,
			force : 750,
			spring : 1.1,
			neighborhoodSpacing : 0,
			optimalPageFill : 1,
			resizePage2Music : 1
		};
		//var gr = guidoEngine.GuidoGetAR2GR(ar);
		//GuidoFreeGR(gr);
		gr = guidoEngine.GuidoGetAR2GRSettings(ar, settings);
		//GuidoFreeGR(gr);
		guidoEngine.delete();
		
		$("#canvasContainer").html(result);
		$("#canvasContainer2").html("<plaintext>" + result + "</plaintext>");
	}
	$( document ).ready(function() {
		//guidoEngine = new Module.GuidoEngineAdapter;
		//guidoEngine.GuidoInit();
		$("#gmnSandbox").on('keyup', processGMN);
	});
	
    </script>
  </head>
  <body>
    <div class="column" style="float:left">
      <p>Type your GMN code here :</p>
      <textarea id="gmnSandbox" rows="40"></textarea>
    </div>
    <div id="canvasContainer" class="column" style="float:right">
    </div>

    <div style="clear:both;"></div>
    <div id="canvasContainer2" class="column">
   
    </div>   <div id="warning"></div>
    <!-- need to insert dummy paragraph to load font -->
    <p id="myP" style="visibility:hidden;font-family:Guido2;font-size:200px"></p>
  </body>
</html>
