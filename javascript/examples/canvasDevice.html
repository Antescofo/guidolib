<!doctype html>
<html>
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" href="../stylesheets/guidostylesheet.css" type="text/css" charset="utf-8" />
	<script type="text/javascript" src="../js/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="../libGUIDOEngine.js"></script>
	<script type="text/javascript" src="../js/jsCanvasDevice.js"></script>
	<style type="text/css">
		div.column {
			display: block;
			width: 50%;
		}
		#gmnSandbox {
			width: 95%;
		}
		#guidoResult {
			/*border: 0px;*/
		}
	</style>
	<script>
		// Global variable for guido engine
		var guidoEngine;
		
	// Process guido code
	function processGMN() {
		var p = guidoEngine.openParser();
		var ar = guidoEngine.string2AR(p, $("#gmnSandbox").val());
		guidoEngine.closeParser(p);
		var gr = guidoEngine.ar2gr(ar);
		
		// draw score in html canvas
		var result = guidoEngine.javascriptExport(gr, 1);
		
		// Free handler
		guidoEngine.freeGR(gr);
		guidoEngine.freeAR(ar);
	}
  
	$( document ).ready(function() {
		// Init guido engine
		guidoEngine = new Module.GuidoEngineAdapter;
		guidoEngine.init();
		
		$("#gmnSandbox").on('keyup', processGMN);
		
		// Init guido canvas (for drawing with javascript device)
		gU1D0cANVA$.initGuidoCanvas();
	});
	</script>
</head>
<body>
	<div class="column" style="float:left">
		<p>Type your GMN code here:</p>
		<textarea id="gmnSandbox" rows="40"></textarea>
	</div>
	<div id="canvasContainer" class="column" style="float:right">
		<canvas></canvas>
	</div>
	<div style="clear:both;"></div>
	<div id="warning"></div>
	<!-- need to insert dummy paragraph to load font -->
	<p style="visibility:hidden;font-family:Guido2;">x</p>
</body>
</html>
